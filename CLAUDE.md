# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

**æœ€æ–°æ›´æ–°è¯´æ˜**ï¼š
- æ–‡ä»¶å·²æ ¹æ®å½“å‰ä»£ç åº“çŠ¶æ€è¿›è¡ŒéªŒè¯å’Œæ›´æ–°
- æµ‹è¯•é…ç½®å·²æ ¹æ®å®é™… Jest é…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ­£
- è„šæœ¬åŠŸèƒ½å·²æ ¹æ® package.json ä¸­çš„å®é™…è„šæœ¬è¿›è¡Œæ›´æ–°
- æ·»åŠ äº† ES æ¨¡å—å’Œæµ‹è¯•æ¶æ„çš„å…·ä½“è¯´æ˜
- æ–°å¢ CHANGELOG.md ç¼–å†™è§„èŒƒï¼Œç¡®ä¿æ›´æ–°æ—¥å¿—é¢å‘ç”¨æˆ·

## Project Overview

è¿™æ˜¯ä¸€ä¸ªåŸºäºæœ¬åœ° Express æœåŠ¡å™¨çš„ CoinGlass åˆ©ç‡ç›‘æ§ç³»ç»Ÿã€‚å®ƒç›‘æ§åŠ å¯†è´§å¸å€Ÿè´·åˆ©ç‡å¹¶åœ¨è¶…è¿‡é˜ˆå€¼æ—¶å‘é€è­¦æŠ¥ã€‚

This is a CoinGlass interest rate monitoring system based on a local Express server. It monitors cryptocurrency lending rates and sends alerts when thresholds are exceeded.

## Architecture

### Core Structure
- **src/app.js** - Express æœåŠ¡å™¨ä¸»å…¥å£ï¼ŒåŒ…å«ä¸­é—´ä»¶é…ç½®ã€è·¯ç”±å’Œå¯åŠ¨é€»è¾‘
- **src/services/** - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æœåŠ¡ï¼š
  - `monitor-service.js` - ä¸»è¦ç›‘æ§é€»è¾‘å’Œé˜ˆå€¼æ£€æŸ¥ï¼ˆä»Cloudflare Workersè¿ç§»ï¼‰
  - `scraper.js` - CoinGlass æ•°æ®æŠ“å–å’Œè§£æï¼ˆä½¿ç”¨Puppeteerï¼‰
  - `email.js` - EmailJS é›†æˆç”¨äºé€šçŸ¥
  - `storage.js` - æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨æœåŠ¡ï¼ˆæ›¿ä»£Cloudflare KVï¼‰
  - `logger.js` - æ—¥å¿—ç®¡ç†æœåŠ¡
  - `data-cleanup.js` - æ•°æ®æ¸…ç†æœåŠ¡ï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ•°æ®ç›®å½•çš„æ¸…ç†
  - `scrape-tracker.js` - æŠ“å–çŠ¶æ€è¿½è¸ªæœåŠ¡ï¼Œå®æ—¶ç›‘æ§æ‰‹åŠ¨è§¦å‘çš„æŠ“å–è¿›åº¦
- **src/utils/** - å·¥å…·æ¨¡å—ï¼š
  - `time-utils.js` - æ—¶é—´æ ¼å¼åŒ–å·¥å…·ï¼Œæä¾›ç»Ÿä¸€çš„æ—¶é—´å¤„ç†å‡½æ•°
- **src/routes/** - API è·¯ç”±ï¼š
  - `config.js` - é…ç½®ç®¡ç†API
  - `status.js` - çŠ¶æ€æŸ¥è¯¢API
  - `scrape.js` - æ•°æ®æŠ“å–API
- **public/** - å‰ç«¯é™æ€æ–‡ä»¶ï¼ˆé€šè¿‡Expressé™æ€æ–‡ä»¶æœåŠ¡ï¼‰ï¼š
  - `index.html` - å‰ç«¯ç®¡ç†ç•Œé¢HTMLç»“æ„
  - `style.css` - å‰ç«¯æ ·å¼æ–‡ä»¶
  - `script.js` - å‰ç«¯JavaScripté€»è¾‘

### Key Components
- **æœ¬åœ°æ–‡ä»¶å­˜å‚¨**ï¼šä½¿ç”¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨é…ç½®ã€çŠ¶æ€å’Œé‚®ä»¶å†å²æ•°æ®
- **Hysteresis é€šçŸ¥ç³»ç»Ÿ**ï¼šé€šè¿‡æ™ºèƒ½å†·å´æœŸé˜²æ­¢åƒåœ¾é‚®ä»¶ï¼Œä¿æŒåŸæœ‰çŠ¶æ€æœºé€»è¾‘
- **è·¨å¹³å°æ”¯æŒ**ï¼šæ”¯æŒWindowsã€macOSå’ŒLinuxéƒ¨ç½²ï¼Œç»Ÿä¸€é…ç½®ç³»ç»Ÿ
- **å¯åŠ¨è„šæœ¬**ï¼šæä¾›Windows PowerShellå’ŒmacOS Bashè„šæœ¬ï¼Œæ™ºèƒ½ç¯å¢ƒæ£€æµ‹å’Œå¯åŠ¨æœåŠ¡
- **Puppeteeræ•°æ®æŠ“å–**ï¼šä½¿ç”¨Stealthæ’ä»¶é¿å…åçˆ¬è™«æ£€æµ‹ï¼Œæ”¯æŒè°ƒè¯•æˆªå›¾
- **EmailJS é›†æˆ**ï¼šEmailJSé‚®ä»¶é€šçŸ¥ç³»ç»Ÿï¼Œæ”¯æŒå¤šå¸ç§é€šçŸ¥æ¨¡æ¿
- **å®šæ—¶ç›‘æ§æœåŠ¡**ï¼šé›†æˆåœ¨ExpressæœåŠ¡å™¨ä¸­çš„å®šæ—¶ä»»åŠ¡ç³»ç»Ÿï¼Œæ”¯æŒçµæ´»è§¦å‘æ—¶é—´
- **æ—¥å¿—ç®¡ç†**ï¼šå®Œæ•´çš„ç»“æ„åŒ–æ—¥å¿—è®°å½•å’Œè‡ªåŠ¨æ¸…ç†ç³»ç»Ÿï¼Œæ”¯æŒå®æ—¶æŸ¥çœ‹
- **æ•°æ®æ¸…ç†æœåŠ¡**ï¼šç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ•°æ®ç›®å½•çš„è‡ªåŠ¨æ¸…ç†ï¼ŒåŒ…æ‹¬é‚®ä»¶å†å²ã€æŠ“å–æ•°æ®ã€æ—¥å¿—æ–‡ä»¶ç­‰
- **æ—¶é—´å·¥å…·æ¨¡å—**ï¼šæä¾›ç»Ÿä¸€çš„æ—¶é—´æ ¼å¼åŒ–å‡½æ•°ï¼Œæ”¯æŒä¸­è‹±æ–‡æ—¶é—´æ˜¾ç¤º
- **ESæ¨¡å—æ¶æ„**ï¼šä½¿ç”¨"type": "module"æ”¯æŒç°ä»£ES6æ¨¡å—è¯­æ³•
- **Webç®¡ç†ç•Œé¢**ï¼šæä¾›ç›´è§‚çš„é…ç½®ç®¡ç†å’ŒçŠ¶æ€ç›‘æ§ç•Œé¢
- **æ™ºèƒ½é…ç½®ç³»ç»Ÿ**ï¼šè‡ªåŠ¨æ£€æµ‹Chromeè·¯å¾„å’Œåˆ›å»ºå¿…è¦ç›®å½•

### Frontend Architecture
å‰ç«¯é‡‡ç”¨æ¨¡å—åŒ–æ¶æ„ï¼Œä»£ç åˆ†ç¦»æå‡å¯ç»´æŠ¤æ€§ï¼š
- **index.html** (147è¡Œ) - çº¯HTMLç»“æ„ï¼Œä¸å«å†…è”æ ·å¼å’Œè„šæœ¬
- **style.css** (475è¡Œ) - æ‰€æœ‰UIæ ·å¼ï¼Œå“åº”å¼è®¾è®¡å’Œä¸»é¢˜
- **script.js** (913è¡Œ) - å®Œæ•´çš„å‰ç«¯é€»è¾‘ï¼ŒåŒ…æ‹¬é…ç½®ç®¡ç†ã€çŠ¶æ€æ›´æ–°ã€é€šçŸ¥ç³»ç»Ÿç­‰
- **Expressé™æ€æœåŠ¡** - é€šè¿‡ `/public` ç›®å½•æä¾›é™æ€æ–‡ä»¶æœåŠ¡
- **é…ç½®æ³¨å…¥** - æœåŠ¡ç«¯åœ¨HTMLä¸­åŠ¨æ€æ³¨å…¥å‰ç«¯ç¯å¢ƒå˜é‡

## Development Commands

### Local Development
```bash
npm start               # Start production server
npm run dev             # Start development server with file watching
npm run dev:debug       # Start server with Node.js debugger
npm run monitor         # Run monitoring service standalone
```

### Platform-specific Scripts
```bash
npm run setup           # Run general setup script (auto-detects Chrome and creates directories)
npm run cleanup         # Run cleanup script (Note: cleanup.js script referenced but may not exist)
```

### Application Startup
```bash
# Windows PowerShell startup script (recommended)
.\scripts\start-windows.ps1

# macOS Bash startup script
./scripts/start-mac.sh

# Standard npm commands
npm start               # Start production server
npm run dev             # Start development server
npm run dev:debug       # Start server with Node.js debugger
npm run monitor         # Run monitoring service standalone
```

### Testing and Debugging
```bash
# Jestæµ‹è¯•æ¡†æ¶ (æ­£å¼æµ‹è¯•)
npm test                # Run Jest test suite
npm run test:watch      # Run tests in watch mode
npm run test:coverage  # Run tests with coverage report

# ç›‘æ§åŠŸèƒ½è°ƒè¯•
npm run monitor         # Run monitoring task manually to test scraping
curl http://localhost:{ç«¯å£}/health    # Check server health
curl http://localhost:{ç«¯å£}/api/status  # Get monitoring status

# ç‹¬ç«‹æµ‹è¯•è„šæœ¬ï¼ˆä½äºtests/ç›®å½•ï¼‰
node tests/test-email-function.js    # Test email functionality
node tests/test-summary-report.js    # Test summary report functionality
```

**æµ‹è¯•æ¶æ„è¯´æ˜**ï¼š
- **Jestæµ‹è¯•æ¡†æ¶**ï¼šæ­£å¼çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼Œä½äºtests/ç›®å½•
- **æµ‹è¯•æ–‡ä»¶ç±»å‹**ï¼šæ”¯æŒ`*.test.js`å’Œ`test-*.js`ä¸¤ç§å‘½åæ¨¡å¼
- **æµ‹è¯•è¦†ç›–**ï¼šåŒ…å«é‚®ä»¶æœåŠ¡ã€é€šçŸ¥è®¾ç½®ã€é›†æˆæµ‹è¯•ç­‰
- **ç‹¬ç«‹æµ‹è¯•è„šæœ¬**ï¼šå¯ç”¨äºè°ƒè¯•å’ŒéªŒè¯ç‰¹å®šåŠŸèƒ½çš„ç‹¬ç«‹è„šæœ¬
- **ESæ¨¡å—æ”¯æŒ**ï¼šJesté…ç½®æ”¯æŒES6æ¨¡å—è¯­æ³•ï¼Œä½¿ç”¨`--experimental-vm-modules`å‚æ•°

### Log Management
```bash
# Logs are automatically written to ./server.log
tail -f ./server.log    # View real-time logs
# Log files are automatically cleaned up (7-day retention)
```

### Access Points
```bash
http://localhost:{ç«¯å£}               # Main monitoring interface
http://localhost:{ç«¯å£}/health       # Health check endpoint
http://localhost:{ç«¯å£}/api/config   # Configuration API
http://localhost:{ç«¯å£}/api/status   # Status API
http://localhost:{ç«¯å£}/api/scrape   # Scraping API
```

## Important Implementation Details

### Environment Variables (ç®€åŒ–é…ç½®ç³»ç»Ÿ)
é¡¹ç›®ä½¿ç”¨æç®€çš„ç¯å¢ƒé…ç½®ç³»ç»Ÿï¼š
- `.env.example` - æ ‡å‡†é…ç½®æ¨¡æ¿ï¼ˆå¤åˆ¶ä¸º.envä½¿ç”¨ï¼‰
- `.env` - å”¯ä¸€çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰å¿…è¦é…ç½®

**é…ç½®åŒ…å«**ï¼š
- æœåŠ¡åŸºç¡€é…ç½®ï¼ˆç«¯å£ã€æ•°æ®ç›®å½•ã€CORSç­‰ï¼‰
  - **æ³¨æ„**: PORT å¿…é¡»é…ç½®ï¼Œç³»ç»Ÿæ— é»˜è®¤ç«¯å£å€¼
- EmailJS é‚®ä»¶é…ç½®ï¼ˆService IDã€Template IDã€å¯†é’¥ç­‰ï¼‰
- Puppeteer æŠ“å–é…ç½®ï¼ˆè¶…æ—¶ã€çª—å£å¤§å°ã€ç­‰å¾…æ—¶é—´ç­‰ï¼‰
- CoinGlass ç½‘ç«™é…ç½®ï¼ˆURLã€ç­‰å¾…æ—¶é—´ã€æˆªå›¾ç›®å½•ç­‰ï¼‰
- æ•°æ®æ ¼å¼åŒ–é…ç½®ï¼ˆå°æ•°ä½æ•°ã€è´§å¸æ ¼å¼ç­‰ï¼‰
- æœåŠ¡å™¨é…ç½®ï¼ˆè¯·æ±‚é™åˆ¶ã€æ—¥å¿—è®¾ç½®ç­‰ï¼‰
- æ—¥å¿—ç®¡ç†é…ç½®ï¼ˆä¿ç•™å¤©æ•°ã€è‡ªåŠ¨æ¸…ç†ç­‰ï¼‰
- å‰ç«¯é…ç½®ï¼ˆæ›´æ–°é—´éš”ã€APIè¶…æ—¶ç­‰ï¼‰
- ç›‘æ§æœåŠ¡é…ç½®ï¼ˆé‡è¯•æ¬¡æ•°ã€å†·å´æ—¶é—´ç­‰ï¼‰

### Port Configuration
- Port must be explicitly configured in .env file (no default values)
- Required configuration: `PORT=<ç«¯å£å·>` in .env file
- Can be overridden via `-Port` parameter in startup scripts
- Startup scripts will fail if PORT is not configured
- Port conflicts are automatically handled by startup scripts

**é…ç½®è®¾ç½®å‘½ä»¤**ï¼š
```bash
npm run setup           # è‡ªåŠ¨æ£€æµ‹ Chrome è·¯å¾„å¹¶åˆ›å»ºå¿…è¦ç›®å½•ï¼ˆæ¨èï¼‰
```

**é¦–æ¬¡ä½¿ç”¨**ï¼š
1. å¤åˆ¶ `.env.example` ä¸º `.env`
2. è¿è¡Œ `npm run setup` è‡ªåŠ¨é…ç½® Chrome è·¯å¾„å’Œåˆ›å»ºç›®å½•
3. ç¼–è¾‘ `.env` é…ç½® EMAILJS_PRIVATE_KEY å’Œå…¶ä»–å¿…è¦å‚æ•°
4. ç¡®ä¿åœ¨ `.env` ä¸­é…ç½®äº† `PORT` å‚æ•°ï¼ˆç³»ç»Ÿæ— é»˜è®¤ç«¯å£ï¼‰

### æœ¬åœ°å­˜å‚¨æ¶æ„
æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ç»“æ„ï¼š
- **æ•°æ®ç›®å½•ç»“æ„**ï¼š
  - `data/config.json` - ç”¨æˆ·é…ç½®æ–‡ä»¶
  - `data/state.json` - ç›‘æ§çŠ¶æ€æ–‡ä»¶ï¼ˆæ”¯æŒå¤šå¸ç§çŠ¶æ€ï¼‰
  - `data/email-history/` - é‚®ä»¶å‘é€å†å²ï¼ˆJSONæ ¼å¼ï¼ŒåŒ…å«æ—¶é—´æˆ³ï¼‰
  - `data/scrape-history/` - æŠ“å–æ•°æ®å†å²ï¼ˆç”¨äºè¶‹åŠ¿åˆ†æï¼‰
  - `data/debug-screenshots/` - è°ƒè¯•æˆªå›¾ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰
  - `data/backups/` - è‡ªåŠ¨å¤‡ä»½ç›®å½•
  - `data/logs/` - ç³»ç»Ÿæ—¥å¿—ç›®å½•
- **è‡ªåŠ¨å¤‡ä»½**ï¼šå®šæœŸå¤‡ä»½é…ç½®å’ŒçŠ¶æ€æ•°æ®åˆ°backupç›®å½•
- **æ•°æ®æ¸…ç†**ï¼šè‡ªåŠ¨æ¸…ç†è¶…è¿‡7å¤©çš„å†å²æ•°æ®å’Œæ—¥å¿—
- **æ–‡ä»¶æ ¼å¼**ï¼šä½¿ç”¨JSONæ ¼å¼å­˜å‚¨ï¼Œä¾¿äºè°ƒè¯•å’Œè¿ç§»
- **å¹¶å‘å®‰å…¨**ï¼šä½¿ç”¨æ–‡ä»¶é”æœºåˆ¶é˜²æ­¢å¹¶å‘å†™å…¥å†²çª

### ç›‘æ§ç³»ç»Ÿæ•°æ®æµ
1. **å®šæ—¶æ£€æŸ¥**ï¼šæœåŠ¡å™¨å¯åŠ¨æ—¶é›†æˆç›‘æ§æœåŠ¡ï¼ŒæŒ‰ç”¨æˆ·é…ç½®çš„æ—¶é—´æ¡ä»¶è§¦å‘
2. **è§¦å‘æ¡ä»¶æ£€æŸ¥**ï¼šæ£€æŸ¥å½“å‰æ—¶é—´æ˜¯å¦æ»¡è¶³hourly_minuteæˆ–daily_hourè®¾ç½®
3. **æ•°æ®æŠ“å–**ï¼šä½¿ç”¨PuppeteeræŠ“å–CoinGlassæ•°æ®ï¼Œæ”¯æŒåçˆ¬è™«ç­–ç•¥
4. **é˜ˆå€¼æ£€æŸ¥**ï¼šå¯¹æ¯”å½“å‰åˆ©ç‡ä¸ç”¨æˆ·è®¾å®šé˜ˆå€¼
5. **çŠ¶æ€ç®¡ç†**ï¼šä½¿ç”¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿè·Ÿè¸ªå¸ç§çŠ¶æ€ï¼Œå®ç°Hysteresisé€»è¾‘
6. **é‚®ä»¶é€šçŸ¥**ï¼šé€šè¿‡EmailJSå‘é€è­¦æŠ¥æˆ–æ¢å¤é€šçŸ¥
7. **å»¶è¿Ÿé€šçŸ¥**ï¼šæ”¯æŒéé€šçŸ¥æ—¶é—´æ®µå†…çš„å»¶è¿Ÿå‘é€æœºåˆ¶

### ç›‘æ§æœåŠ¡å®ç°è¯´æ˜
- **ä¸»è¦ç›‘æ§é€»è¾‘**ï¼šä½äº `src/services/monitor-service.js`ï¼ŒåŒ…å«å®Œæ•´çš„ç›‘æ§åŠŸèƒ½
- **ç‹¬ç«‹ç›‘æ§æœåŠ¡**ï¼š`src/services/monitor.js` æä¾›ç‹¬ç«‹çš„ç›‘æ§åŠŸèƒ½ï¼Œç”¨äºæµ‹è¯•
- **ç‹¬ç«‹è¿è¡Œ**ï¼šå¯é€šè¿‡ `npm run monitor` ç‹¬ç«‹æ‰§è¡Œç›‘æ§ä»»åŠ¡è¿›è¡Œæµ‹è¯•

### Hysteresisé€šçŸ¥é€»è¾‘
- **é¦–æ¬¡è§¦å‘**ï¼šåˆ©ç‡ > é˜ˆå€¼ â†’ ç«‹å³é€šçŸ¥ï¼ˆå¦‚æœåœ¨é€šçŸ¥æ—¶é—´æ®µå†…ï¼‰
- **æŒç»­è­¦æŠ¥**ï¼šæŒ‰repeat_intervalè®¾ç½®é‡å¤é€šçŸ¥ï¼ˆé»˜è®¤180åˆ†é’Ÿï¼‰
- **æ¢å¤é€šçŸ¥**ï¼šåˆ©ç‡ â‰¤ é˜ˆå€¼ â†’ ç«‹å³æ¢å¤é€šçŸ¥
- **æ—¶é—´æ§åˆ¶**ï¼šæ”¯æŒnotification_hoursæ—¶é—´çª—å£è®¾ç½®
- **å»¶è¿Ÿé€šçŸ¥**ï¼šéæ—¶é—´æ®µå†…è‡ªåŠ¨å®‰æ’åˆ°ä¸‹ä¸€ä¸ªå…è®¸æ—¶é—´å‘é€

### Puppeteeræ•°æ®æŠ“å–
- **åæ£€æµ‹é…ç½®**ï¼šä½¿ç”¨puppeteer-extra-plugin-stealthé¿å…åçˆ¬è™«æ£€æµ‹
- **æµè§ˆå™¨é…ç½®**ï¼šæ”¯æŒæ— å¤´æ¨¡å¼å’Œå®Œæ•´æµè§ˆå™¨æ¨¡å¼ï¼Œå¯è‡ªå®šä¹‰çª—å£å¤§å°
- **æ™ºèƒ½ç­‰å¾…ç­–ç•¥**ï¼šé’ˆå¯¹CoinGlassç½‘ç«™çš„ä¸åŒå…ƒç´ è®¾ç½®ä¸“é—¨ç­‰å¾…æ—¶é—´
- **æ•°æ®è§£æ**ï¼šæå–å¸ç§åˆ©ç‡ã€å†å²è¶‹åŠ¿ã€äº¤æ˜“æ‰€æ•°æ®ç­‰å…³é”®ä¿¡æ¯
- **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„ç½‘ç»œé”™è¯¯å’Œæ•°æ®è§£æé”™è¯¯å¤„ç†ï¼Œæ”¯æŒé‡è¯•æœºåˆ¶
- **è°ƒè¯•æ”¯æŒ**ï¼šå¯é€‰çš„æˆªå›¾åŠŸèƒ½ï¼Œä¾¿äºè°ƒè¯•æ•°æ®æŠ“å–é—®é¢˜
- **Chromeæ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹ç³»ç»ŸChromeè·¯å¾„ï¼Œæœªæ‰¾åˆ°æ—¶ä½¿ç”¨å†…ç½®Chromium

### æ—¥å¿—ç³»ç»Ÿ
- **è‡ªåŠ¨æ—¥å¿—æ•è·**ï¼šé‡å†™consoleæ–¹æ³•ï¼Œæ•è·æ‰€æœ‰ç³»ç»Ÿæ—¥å¿—
- **åŒé‡æ—¥å¿—è¾“å‡º**ï¼šåŒæ—¶è¾“å‡ºåˆ°æ§åˆ¶å°å’Œæ–‡ä»¶ï¼ˆ./server.logï¼‰
- **æ—¥å¿—æ¸…ç†**ï¼šè‡ªåŠ¨æ¸…ç†7å¤©å‰çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¯é…ç½®ä¿ç•™å¤©æ•°
- **ç»“æ„åŒ–æ—¥å¿—**ï¼šåŒ…å«æ—¶é—´æˆ³ã€çº§åˆ«ã€æ¨¡å—ä¿¡æ¯
- **æ—¥å¿—API**ï¼šé€šè¿‡Webç•Œé¢æŸ¥çœ‹å’Œç®¡ç†æ—¥å¿—
- **æ€§èƒ½ç›‘æ§**ï¼šè®°å½•APIè¯·æ±‚æ—¶é—´å’Œç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡
- **é”™è¯¯è¿½è¸ª**ï¼šè¯¦ç»†çš„é”™è¯¯å †æ ˆå’Œä¸Šä¸‹æ–‡ä¿¡æ¯

## é…ç½®ç»“æ„

ç”¨æˆ·é…ç½®å­˜å‚¨åœ¨ `data/config.json`ï¼š
```json
{
  "email": "user@example.com",
  "monitoring_enabled": true,
  "filters": {
    "exchange": "binance",
    "coin": "USDT",
    "timeframe": "1h"
  },
  "coins": [
    {
      "symbol": "USDT",
      "exchange": "binance",
      "timeframe": "1h",
      "threshold": 5.0,
      "enabled": true
    }
  ],
  "trigger_settings": {
    "hourly_minute": 0,
    "daily_hour": 9,
    "daily_minute": 0
  },
  "notification_hours": {
    "enabled": true,
    "start": "09:00",
    "end": "24:00"
  },
  "repeat_interval": 180
}
```

### è§¦å‘æ—¶é—´è®¾ç½®
- **æ¯å°æ—¶è§¦å‘**ï¼š0-59åˆ†é’Ÿï¼Œè¡¨ç¤ºæ¯å°æ—¶çš„ç¬¬å‡ åˆ†é’Ÿæ‰§è¡Œç›‘æ§
- **æ¯24å°æ—¶è§¦å‘**ï¼šH:MMæ ¼å¼ï¼Œè¡¨ç¤ºæ¯å¤©ç‰¹å®šæ—¶é—´æ‰§è¡Œç›‘æ§
- **åŒæ—¶æ£€æŸ¥**ï¼šç³»ç»ŸåŒæ—¶æ£€æŸ¥ä¸¤ä¸ªè§¦å‘æ¡ä»¶ï¼Œä»»ä¸€æ»¡è¶³å³æ‰§è¡Œ
- **çµæ´»é…ç½®**ï¼šæ”¯æŒä»…æ¯å°æ—¶ã€ä»…æ¯24å°æ—¶æˆ–åŒæ—¶å¯ç”¨

## APIæ¥å£
- `GET /api/config` - è·å–ç”¨æˆ·é…ç½®
- `POST /api/config` - ä¿å­˜ç”¨æˆ·é…ç½®
- `GET /api/status` - è·å–å½“å‰ç›‘æ§çŠ¶æ€
- `GET /api/scrape` - æ‰‹åŠ¨è§¦å‘æ•°æ®æŠ“å–
- `POST /api/scrape/coinglass` - æ‰‹åŠ¨è§¦å‘å®Œæ•´ç›‘æ§æµç¨‹
- `GET /api/scrape/status` - è·å–å½“å‰æŠ“å–çŠ¶æ€ï¼ˆå®æ—¶è¿›åº¦ï¼‰
- `GET /api/scrape/service-status` - è·å–æŠ“å–æœåŠ¡çŠ¶æ€ï¼ˆæµè§ˆå™¨æœåŠ¡çŠ¶æ€ï¼‰
- `GET /api/scrape/history` - è·å–æŠ“å–å†å²è®°å½•
- `GET /health` - æœåŠ¡å™¨å¥åº·æ£€æŸ¥

## EmailJSé…ç½®
ç³»ç»Ÿæ”¯æŒé€šè¿‡ EmailJS å‘é€é‚®ä»¶é€šçŸ¥ï¼Œéœ€è¦é…ç½®ä»¥ä¸‹å‚æ•°ï¼š
- **EMAILJS_SERVICE_ID**: EmailJS æœåŠ¡ID
- **EMAILJS_TEMPLATE_ID**: é‚®ä»¶æ¨¡æ¿ID
- **EMAILJS_PUBLIC_KEY**: EmailJS å…¬é’¥
- **EMAILJS_PRIVATE_KEY**: EmailJS ç§é’¥
- **EMAILJS_API_URL**: EmailJS APIåœ°å€

**æ¨¡æ¿åŠŸèƒ½**ï¼š
- å¤šå¸ç§æ”¯æŒä¸æ•°ç»„å¾ªç¯
- çŠ¶æ€æ¡ä»¶æ¸²æŸ“
- å†å²æ•°æ®è¡¨æ ¼
- å®æ—¶çŠ¶æ€ç›‘æ§

## CHANGELOG ç¼–å†™è§„èŒƒ

### ğŸ“ æ›´æ–°æ—¥å¿—åŸåˆ™
CHANGELOG.md å¿…é¡»é¢å‘ç”¨æˆ·ï¼Œå…³æ³¨åŠŸèƒ½æ”¹è¿›å’Œä½“éªŒæå‡ï¼Œé¿å…æŠ€æœ¯ç»†èŠ‚ï¼š

**âœ… åº”è¯¥åŒ…å«**ï¼š
- åŠŸèƒ½æ”¹è¿›ï¼ˆå¦‚"æ–°å¢å®æ—¶è¿›åº¦æ˜¾ç¤º"ï¼‰
- ä½“éªŒä¼˜åŒ–ï¼ˆå¦‚"é¡µé¢åŠ è½½æ›´å¿«"ã€"æ“ä½œæ›´æµç•…"ï¼‰
- é—®é¢˜ä¿®å¤ï¼ˆå¦‚"ä¿®å¤é‚®ä»¶å‘é€å¤±è´¥é—®é¢˜"ï¼‰
- ç”¨æˆ·ä»·å€¼ï¼ˆå¦‚"èŠ‚çœå­˜å‚¨ç©ºé—´"ã€"é¿å…æ·±å¤œæ‰“æ‰°"ï¼‰

**âŒ é¿å…åŒ…å«**ï¼š
- APIç«¯ç‚¹å˜æ›´ï¼ˆå¦‚"/api/scrape/statusç«¯ç‚¹"ï¼‰
- æŠ€æœ¯æ¶æ„ï¼ˆå¦‚"å‰ç«¯æ¨¡å—åŒ–é‡æ„"ï¼‰
- å†…éƒ¨æœåŠ¡ï¼ˆå¦‚"ScrapeTrackeræœåŠ¡"ï¼‰
- ä»£ç ç»†èŠ‚ï¼ˆå¦‚"åˆ†ç¦»HTMLã€CSSæ–‡ä»¶"ï¼‰

**ğŸ”„ è¯­è¨€é£æ ¼**ï¼š
- ç”¨ç”¨æˆ·èƒ½ç†è§£çš„é€šä¿—è¯­è¨€
- çªå‡ºå®é™…ä»·å€¼å’Œä½“éªŒæ”¹è¿›
- ä¿æŒç®€æ´æ˜äº†ï¼Œæ¯æ¡ä¸è¶…è¿‡15å­—

**ğŸ“‹ ç‰ˆæœ¬æ ¼å¼**ï¼š
```json
{
  "version": "v25.10.6.9",
  "date": "2025-10-06",
  "description": "ç®€è¦æè¿°æœ¬æ¬¡æ›´æ–°ä¸»é¢˜",
  "changes": [
    "ğŸ¯ åŠŸèƒ½æ”¹è¿›1",
    "âš¡ æ€§èƒ½ä¼˜åŒ–1",
    "ğŸ› é—®é¢˜ä¿®å¤1"
  ]
}
```

## é‡è¦è¯´æ˜

### âš ï¸ Git æ“ä½œé™åˆ¶
**é‡è¦**ï¼šæœªç»ç”¨æˆ·æ˜ç¡®è®¸å¯ï¼Œç¦æ­¢æ‰§è¡Œä»»ä½• Git æ“ä½œï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š
- `git add .`
- `git commit`
- `git push`
- ä»»ä½•å…¶ä»– Git å‘½ä»¤

### ç›‘æ§è„šæœ¬æ¾„æ¸…
- `npm run monitor` è¿è¡Œçš„æ˜¯ `src/services/monitor.js`ï¼ˆç‹¬ç«‹æµ‹è¯•ç‰ˆæœ¬ï¼‰
- å®Œæ•´çš„ç›‘æ§é€»è¾‘åœ¨ `src/services/monitor-service.js` ä¸­ï¼ˆé›†æˆåˆ°ä¸»æœåŠ¡å™¨ï¼‰
- è¦è¿è¡Œå®Œæ•´ç›‘æ§ï¼Œéœ€è¦å¯åŠ¨ä¸»æœåŠ¡å™¨ (`npm start` æˆ– `npm run dev`)

### è„šæœ¬è¯´æ˜
- `scripts/start-windows.ps1` âœ… Windows PowerShell å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
- `scripts/start-mac.sh` âœ… macOS Bash å¯åŠ¨è„šæœ¬
- `scripts/cleanup.js` æ¸…ç†è„šæœ¬ï¼ˆåœ¨package.jsonä¸­å¼•ç”¨ï¼‰

**æ³¨æ„**:
- éƒ¨ç½²è„šæœ¬ (`deploy-windows.ps1`, `deploy-mac.sh`) å·²è¢«ç®€åŒ–ä¸ºå¯åŠ¨è„šæœ¬
- åŸºç¡€é…ç½®åŠŸèƒ½ç°åœ¨é€šè¿‡ `npm run setup` å‘½ä»¤æä¾›

### é…ç½®æ–‡ä»¶ä½¿ç”¨è¯´æ˜

#### ğŸ”§ å¯åŠ¨è„šæœ¬ä½¿ç”¨

**Windows PowerShell å¯åŠ¨è„šæœ¬**ï¼š
```powershell
# åŸºç¡€å¯åŠ¨
.\scripts\start-windows.ps1

# å¼€å‘æ¨¡å¼
.\scripts\start-windows.ps1 -Dev

# è°ƒè¯•æ¨¡å¼
.\scripts\start-windows.ps1 -Debug

# è‡ªå®šä¹‰ç«¯å£
.\scripts\start-windows.ps1 -Port 8080

# ç»„åˆå‚æ•°
.\scripts\start-windows.ps1 -Dev -Port 8080
```

**macOS Bash å¯åŠ¨è„šæœ¬**ï¼š
```bash
# åŸºç¡€å¯åŠ¨
./scripts/start-mac.sh

# å¼€å‘æ¨¡å¼
./scripts/start-mac.sh --dev

# è°ƒè¯•æ¨¡å¼
./scripts/start-mac.sh --debug

# è‡ªå®šä¹‰ç«¯å£
./scripts/start-mac.sh --port 8080
```

**å¯åŠ¨è„šæœ¬åŠŸèƒ½**ï¼š
- âœ… è‡ªåŠ¨æ£€æµ‹ Node.js å’Œ npm ç‰ˆæœ¬
- âœ… æ™ºèƒ½ç«¯å£å†²çªå¤„ç†
- âœ… è‡ªåŠ¨åˆ›å»ºå¿…è¦ç›®å½•
- âœ… ä¾èµ–æ£€æŸ¥å’Œæ›´æ–°æé†’
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º

---

#### ğŸ”§ æ‰‹åŠ¨é…ç½®æ–¹å¼

**ä¼ ç»Ÿå®‰è£…**ï¼š
1. å¤åˆ¶ `.env.example` ä¸º `.env`
2. è¿è¡Œ `npm run setup` è‡ªåŠ¨é…ç½® Chrome è·¯å¾„å’Œåˆ›å»ºå¿…è¦ç›®å½•
3. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œä¸»è¦é…ç½® `EMAILJS_PRIVATE_KEY` å’Œå…¶ä»–å¿…è¦å‚æ•°

**ç°æœ‰ç”¨æˆ·**ï¼š
- å¦‚æœå·²æœ‰ `.env` æ–‡ä»¶ï¼Œç›´æ¥è¿è¡Œ `npm run setup` æ›´æ–° Chrome è·¯å¾„
- æ‰€æœ‰é…ç½®ç°åœ¨é›†ä¸­åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ— éœ€ç®¡ç†å¤šä¸ªé…ç½®æ–‡ä»¶

**ç›®å½•ç»“æ„**ï¼š
- `data/` ç›®å½•ä¼šåœ¨é¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»º
- åŒ…å« `config.json`ã€`state.json`ã€`email-history/`ã€`scrape-history/` ç­‰å­ç›®å½•
- è°ƒè¯•æˆªå›¾ç›®å½• `debug-screenshots/` å¯é€‰åˆ›å»º

## Web ç•Œé¢åŠŸèƒ½

### ä¸»è¦åŠŸèƒ½
- **é…ç½®ç®¡ç†**ï¼šé€šè¿‡Webç•Œé¢ç¼–è¾‘å’Œä¿å­˜é…ç½®
- **çŠ¶æ€ç›‘æ§**ï¼šå®æ—¶æ˜¾ç¤ºç›‘æ§çŠ¶æ€å’Œå¸ç§ä¿¡æ¯
- **å†å²æ•°æ®**ï¼šæŸ¥çœ‹æŠ“å–å†å²å’Œé‚®ä»¶å‘é€è®°å½•
- **æ—¥å¿—æŸ¥çœ‹**ï¼šé€šè¿‡ç•Œé¢æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
- **æ‰‹åŠ¨æ“ä½œ**ï¼šæ‰‹åŠ¨è§¦å‘æ•°æ®æŠ“å–å’Œç›‘æ§ä»»åŠ¡

### API ç«¯ç‚¹
- `GET /` - ä¸»é¡µé¢ï¼ˆå‰ç«¯ç•Œé¢ï¼‰
- `GET /api/config` - è·å–é…ç½®
- `POST /api/config` - ä¿å­˜é…ç½®
- `GET /api/status` - è·å–ç›‘æ§çŠ¶æ€
- `GET /api/scrape` - æ‰‹åŠ¨è§¦å‘æ•°æ®æŠ“å–
- `GET /health` - å¥åº·æ£€æŸ¥

## æŠ€æœ¯æ ˆè¯¦æƒ…

### æ ¸å¿ƒä¾èµ–
- **express**: Web æœåŠ¡å™¨æ¡†æ¶
- **puppeteer**: ç½‘é¡µè‡ªåŠ¨åŒ–å’Œæ•°æ®æŠ“å–
- **puppeteer-extra**: Puppeteer å¢å¼ºæ’ä»¶
- **puppeteer-extra-plugin-stealth**: åæ£€æµ‹æ’ä»¶
- **dotenv**: ç¯å¢ƒå˜é‡ç®¡ç†
- **cors**: è·¨åŸŸèµ„æºå…±äº«
- **node-cron**: å®šæ—¶ä»»åŠ¡è°ƒåº¦
- **winston**: æ—¥å¿—ç®¡ç†ï¼ˆå¯é€‰ï¼‰

### å¼€å‘ä¾èµ–
- **nodemon**: å¼€å‘æ—¶è‡ªåŠ¨é‡å¯
- **jest**: æµ‹è¯•æ¡†æ¶ï¼Œæ”¯æŒESæ¨¡å—
- **wrangler**: Cloudflare Workers å·¥å…·ï¼ˆä¿ç•™ç”¨äºå…¼å®¹æ€§ï¼‰

### æ¶æ„ç‰¹ç‚¹
- **ES6 æ¨¡å—**: ä½¿ç”¨ import/export è¯­æ³•ï¼Œ`"type": "module"` é…ç½®
- **å¼‚æ­¥ç¼–ç¨‹**: å…¨é¢ä½¿ç”¨ async/await
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„ try-catch å’Œé”™è¯¯ä¼ æ’­
- **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„æœåŠ¡å±‚å’Œè·¯ç”±å±‚åˆ†ç¦»
- **æµ‹è¯•æ¶æ„**: Jesté…ç½®æ”¯æŒES6æ¨¡å—ï¼ŒåŒ…å«å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•